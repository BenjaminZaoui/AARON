name: Deploy on Push to Main

# Déclencheur pour les événements "push" sur la branche "main"
on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # Étape 1 : Vérification du code source
      - name: Checkout code
        uses: actions/checkout@v3

      # Étape 2 : Configurer l'accès SSH
      - name: Set up SSH
        run: |
          mkdir -p ~/.ssh
          echo "LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUNGd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFnRUFzMTRRazd1R3ZrdXRTbE00b0xXOXYvTzlFc2EyMXQ1ZWRTek1Fak9vZEQ2WWxOTkcvK1BkCmIyaTlObk5QT1lEZnBaVVdxSXJpcTBzSU0vNXdNSDU2QXRpU01CbGdINitwUHlOS202NkVHV29naVJsajUwRHFoL28wOGIKdURYdlQ5Rk1GL3AycjAzUFdlNDgzL3N0UWI5dnVLdk80TTFwTVl3VGlxa2xKTFNsTC9oaFBWSGtHWndJVGRvNmRzc3JXVgo5WEhQc1N0L1pZaVV4NDdsRTVTczdTRFE4OFkyZE1CRnpacVdPS01mdEJTaksyRWRZV05TUUh6MVRVSmJsYUoyZjlkL2hHCmt6N0tLU2dQRk5wbzFmZndSM1E0S3l2MXZxR0M1RTg5WkxkWFJ2QklSZzhUMjc5bE1sT1JoZkVZMTNRNWk1c05ndEw5TU8KdzVDRFJsQytnTFlCMWZ3SktLTEZ6cnMrb1RrWWs1ZVVXbklqWXUwWUExWFZiTUliZU9JejZ2WkxYYSs0R2VYVmlSUGI5TwphQXNXeWo0WHcxcDd4L0VYdWN5RTVoMDJ2N3prRE5EUUwxcS9PTDQ0YUlFVllhRXFUdCtySHIyZDJFaVlxOGV5akRLTi84CjZjTnFBRXpCOENoSUNuYmZXaEhqalBVWk1ZcGI3dXNONTRrSlp3OGtQOE5VcDgzOUYySlYwekhLUTRtemkrQllXYnhyaUkKQ04rMzEwbWVjVHNJUmpKenBoeEdYeXhGeVYxdzMzbzhvUUVUVnpKWlBLZWIxb2dyQ3hiRDAyMlh6aUU0OFBiYVBFQVQ5OQorTk1hT0F0SCsvZ2VBaldOT1ArSmdLZnZZZ0hNdnd0NlovN0NJZUZYcVNvWGJ2TUFsM1BneUtxaEpNNktuWmdrRFg2WEZkCkVBQUFkUUNUeEdVQWs4UmxBQUFBQUhjM05vTFhKellRQUFBZ0VBczE0UWs3dUd2a3V0U2xNNG9MVzl2L085RXNhMjF0NWUKZFN6TUVqT29kRDZZbE5ORy8rUGRiMmk5Tm5OUE9ZRGZwWlVXcUlyaXEwc0lNLzV3TUg1NkF0aVNNQmxnSDYrcFB5TkttNgo2RUdXb2dpUmxqNTBEcWgvbzA4YnVEWHZUOUZNRi9wMnIwM1BXZTQ4My9zdFFiOXZ1S3ZPNE0xcE1Zd1RpcWtsSkxTbEwvCmhoUFZIa0dad0lUZG82ZHNzcldWOVhIUHNTdC9aWWlVeDQ3bEU1U3M3U0RRODhZMmRNQkZ6WnFXT0tNZnRCU2pLMkVkWVcKTlNRSHoxVFVKYmxhSjJmOWQvaEdrejdLS1NnUEZOcG8xZmZ3UjNRNEt5djF2cUdDNUU4OVpMZFhSdkJJUmc4VDI3OWxNbApPUmhmRVkxM1E1aTVzTmd0TDlNT3c1Q0RSbEMrZ0xZQjFmd0pLS0xGenJzK29Ua1lrNWVVV25Jall1MFlBMVhWYk1JYmVPCkl6NnZaTFhhKzRHZVhWaVJQYjlPYUFzV3lqNFh3MXA3eC9FWHVjeUU1aDAydjd6a0RORFFMMXEvT0w0NGFJRVZZYUVxVHQKK3JIcjJkMkVpWXE4ZXlqREtOLzg2Y05xQUV6QjhDaElDbmJmV2hIampQVVpNWXBiN3VzTjU0a0padzhrUDhOVXA4MzlGMgpKVjB6SEtRNG16aStCWVdieHJpSUNOKzMxMG1lY1RzSVJqSnpwaHhHWHl4RnlWMXczM284b1FFVFZ6SlpQS2ViMW9nckN4CmJEMDIyWHppRTQ4UGJhUEVBVDk5K05NYU9BdEgrL2dlQWpXTk9QK0pnS2Z2WWdITXZ3dDZaLzdDSWVGWHFTb1hidk1BbDMKUGd5S3FoSk02S25aZ2tEWDZYRmRFQUFBQURBUUFCQUFBQ0FBR295cFBrc3VQSEhVWU5zRkN2bUlpZ3psVTlyQ2FzUCtRVQpwQXpwdFFFYlpoYjhlWWk4bmpzU1c3SU9aY0hrdmJUc2ptYStTT0ZweFF4cmx0UzhOOHozblZDMExHU3FQOTRYY3pPMUxQCmFBWUcyTmR5cTVZRHJkNGJhVTd6SDBqaFFyYWo3TDl1d0Z1b2ljQU93Ymd3SVJTUy9aN3NaL1FQK2l0YWZCd1IyN1JPaXEKVnpxbTNWWDBtTFpEbStsdkxXUm91L2dJVmtWWEdzT05NNjRsdXdaYzBYNXlDZ3ZheUE2SXR1bTdKWDh6R2puaUxCT3lnVwpuMGZTOVAwNVRaWE1CQml3WGVyZ2g3RGYydndwZzZZK21EQkdDV0h3S1ZYTStidTBXWUtQd1RKYmE2R0x5a21ObXhmRmlJClQ1THc2SlRpSHVGYVZHdVdMaTBNTk4yeFUwSnQwOHBPeGNhTm1YZkN1Tzhxem82UHlaR2ZIbU5DaHM1YTVHMktDNS9ia1IKcTRnYTZKL1h6WHNlSjU2T28vc25KNmVTaWZoSHIvS0lDSEJLMk9NV0tuY2NDZTRSbW9iRVlhdmhsWlNobHhGSVFQT2hIVQp1ZUZCakFSdno2eDgxQ1YyT3NjSGhKcmY3VmEwQ0tRRXc1aFNuYy9XUkJyUFRlZlpRUHhPbkxCTkZsUmpIalR1NWxWZGNBCllXV0tKVXNqUGdLTlh6Q3JjU3JVUndjeTkrYUlDNWRCbExIbEREMVVFMnAzMHZIeGtlWnBiSFEvb1ErUzNmM2NWOWxndmQKUEk5VDFYT3l5QWVjbC9TUWlDKzNmcnVaWGswNzdKSTE2OFhGVXFkOXRPQUhISEhGMW03SVJJL1FRNUVpMWpSQmxTZ051ZwpUbkVCWGtFOGZNWExWaTlLd2hBQUFCQVFESXg5SkpndmZLUmh6OW1lczJyNzc4L2g0UFgrZS8xMjdYUU5BK3lWTUxieldiCnB4ZDJzYVZlNWhOVFdWV3N5S0Q4a3dOaWZ6VTg3MzhvRkpZUldVQU5uazZLYWVsaGgyRWtpeXZIM2FRSWNuaDdtU09VajMKbXJRTzFQQ05pRGY4eUtGYTRLeTNiaDlpd1RPd2lOWmcrbndiUDM4Vzk5b0pEVHI3cXB2b1NQNnZiQklCTDJ6SXFWSUYxbAo2YWVxMFYxWi9xN3E4Q0RyYklvK2p5Y054VzQyN3BZT1J1MHYrZkNrZGdQVkhPbnZValRIQ2t3T3VNU1BzUStzZ0xzRXZrClJtbHRzQ1V1dlYreEpQbnNTa2ZiaW9Ob1J5YlFDQWE5Nm1kOUNxRFpSb1UrUVh0bnVVWXBmY05ScHpHNHJvQ0xyWTZreWkKM1NwQjdzS3V3RVhHUU9ZZUFBQUJBUURiQjJYeGJ3N1E5Yk95cHB3TDAva3hxWGRWRUJjMHVZbWtOZjRFSjVLdGhEWVhobQozZEpwSkcwejBLUVREYWZFTnBGeXc3V2ZGTWNlMFE4bDdtNVFXYkQzenlCNUkvZnpZdHN6dDBuQmsxcFF1Rko0VjcwRjhxCjhuanBBTEFGTWwzQmMxUWp4Wk1MV3ZRUm5UbU5hN2hOZmdIWU9NQTczaEhsM1ZHM1RYYTRPOGk5eDVTaE1SWmZ5SW5ZM1IKYzhCZ3NNUm5kUGhNSTRLbzBJUHFLZHcvUDkwdDdFL3FpUE90djNlQk9DSUM5bHJ5a3NLTjZFK1NScUZtbUx2bCtHdW96egpJSzk1MGJldmkwUkZ2SmxLTTRVZHZXa2tqeE1jdmhod1BvZklWZ2lsOWJxVVVBdjdNNHppaDVrSzR0c1djaE1kVGw2WEZpCjhnekRUbThaRkNmR2toQUFBQkFRRFJwTlJFQTBhWDBIM3RRQ1BtRUFLbGxDZW5hMFMwZGp2MmQwcGJKSENlMG9QYjd4VnMKcU9CZzVCWlhXb0hyTTBMdVovSzNKekZrNE5iZEJGNzBuQ1FQODFZYVF4aTlwM0Jvb1RHRHZqempFTFBHMHF4V091YlJMRgprMnNqRjZrSlMrbytoUG9QZXNoNnRVb09jbXlZRnpSUFh4cmZxa2Fxa2d4Tk1SQTUvcG5tNHFpV2Y2d214alJCQ0ZYOHpoClBMYVhLczhQS2JSRnMyR29HS2prLzYvSzJKMUhtTFYwelg4UzBLSy8zVE9Ha2xQOFhncDNVYmVGRFUweXd5SzRCdkVEdW8Kd3Y2alhISTk3bkg1K1dEZDZmeVAyTU5veWlKOWxWc1pwTmNaZE90WmszNVR3OEU1aVpscWRtS1hobjArOGRUUkNLMGhSWQpDUlVMUE1jcWg2YXhBQUFBR21KbGJtcGhiV2x1ZW1GdmRXbHdjbTlBWjIxaGFXd3VZMjl0Ci0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan 3.89.252.255 >> ~/.ssh/known_hosts

      # Étape 3 : Exécuter le pull sur Le serveurs
      - name: Pull latest changes on the server
        run: |
          ssh raphyserver@3.89.252.255 <<EOF
            cd /home/raphyserver/www/AARON
          EOF
